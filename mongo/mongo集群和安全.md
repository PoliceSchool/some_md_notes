## MongoDB集群和安全

### 课程目标

* MongoDB的副本集:操作,主要概念,故障转移,选举规则
* MongoDB的分片集群:概念,有点,操作,分片策略,故障转移
* MongoDB的安全认证

### 1. 副本集-Replica Sets

#### 1.1 简介

MongoDB中的副本集(Replica Set)是一组维护相同数据集的mongod服务,副本集可提供冗余和高可用性,是所有生产部署的基础.

也可以说,副本集群类似于有自动故障恢复功能的主从集群.通俗的讲就是用多台机器进行同一数据的异步同步,从而使多台机器拥有同一数据的多个副本,并且当主库down掉时在不需要用户干预的情况下自动切换其他备份服务器做主库.而且还可以利用副本服务器做只读服务器,实现读写分离,提高负载.

#### 1.2 副本集的三个角色

副本集有两种类型三种角色

两种类型:

* 主节点(Primary)类型:数据操作的主要连接点,可读写
* 次要(辅助,从)节点(Secondaries)类型:数据冗余备份节点,可以读或者选举

三种角色:

* 主要成员(Primary):主要接收所有写操作.就是主节点
* 副本成员(Replicate):从主接节点通过复制操作以维护相同的数据集,即备份数据,不可写操作,但可以读操作(但需要配置).是默认的一种从节点类型.
* 仲裁者(Arbiter):不保留任何数据的副本,只具有投票选举作用.当然也可以将仲裁服务器维护为副本集的一部分,即副本成员同事也可以是仲裁者.也会一种从节点类型.

#### 1.3 副本集架构目标

一主一副本一仲裁

#### 1.4.1 第一步:创建主节点

建立存放数据和日志的目录

